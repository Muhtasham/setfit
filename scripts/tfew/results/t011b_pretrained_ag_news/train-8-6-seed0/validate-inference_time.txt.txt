VALIDATE Profiler Report
Profile stats for: configure_callbacks
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 lightning.py:1199(configure_callbacks)



Profile stats for: prepare_data
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 hooks.py:325(prepare_data)



Profile stats for: on_before_accelerator_backend_setup
         46 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:35(on_before_accelerator_backend_setup)
        3    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 module.py:1194(__getattr__)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        4    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        3    0.000    0.000    0.000    0.000 base.py:63(on_before_accelerator_backend_setup)
        3    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: setup
         42 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:45(setup)
        3    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        3    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        3    0.000    0.000    0.000    0.000 base.py:67(setup)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:373(setup)



Profile stats for: configure_sharded_model
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 hooks.py:298(configure_sharded_model)



Profile stats for: on_configure_sharded_model
         46 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:40(on_configure_sharded_model)
        3    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 module.py:1194(__getattr__)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        3    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        3    0.000    0.000    0.000    0.000 base.py:60(on_configure_sharded_model)



Profile stats for: on_val_dataloader
         14 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:628(on_val_dataloader)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)



Profile stats for: run_validate_evaluation
         126 function calls (125 primitive calls) in 417.618 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000  417.618  417.618 base.py:109(run)
        1    0.000    0.000  417.618  417.618 evaluation_loop.py:88(on_run_start)
        1    0.000    0.000  417.618  417.618 evaluation_loop.py:182(_on_evaluation_model_eval)
        1    0.000    0.000  417.618  417.618 trainer.py:1481(call_hook)
        1    0.000    0.000  417.618  417.618 contextlib.py:107(__enter__)
        1    0.000    0.000  417.618  417.618 {built-in method builtins.next}
        1    0.000    0.000  417.618  417.618 base.py:68(profile)
        1    0.000    0.000  417.618  417.618 advanced.py:61(start)
        1  417.618  417.618  417.618  417.618 {method 'enable' of '_lsprof.Profiler' objects}
        8    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
        2    0.000    0.000    0.000    0.000 evaluation_loop.py:151(_get_max_batches)
        1    0.000    0.000    0.000    0.000 evaluation_loop.py:74(reset)
        1    0.000    0.000    0.000    0.000 evaluation_loop.py:68(skip)
        1    0.000    0.000    0.000    0.000 trainer.py:2116(_evaluation_loop)
    14/13    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 module.py:1210(__setattr__)
        3    0.000    0.000    0.000    0.000 trainer.py:1968(testing)
        1    0.000    0.000    0.000    0.000 grad_mode.py:131(__enter__)
       16    0.000    0.000    0.000    0.000 types.py:164(__get__)
        1    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        2    0.000    0.000    0.000    0.000 trainer.py:2016(sanity_checking)
        1    0.000    0.000    0.000    0.000 grad_mode.py:126(__init__)
        1    0.000    0.000    0.000    0.000 parameter.py:9(__instancecheck__)
        1    0.000    0.000    0.000    0.000 dataloader_loop.py:56(reset)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 grad_mode.py:226(__init__)
        1    0.000    0.000    0.000    0.000 contextlib.py:237(helper)
        1    0.000    0.000    0.000    0.000 progress.py:154(reset_on_run)
        1    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
       16    0.000    0.000    0.000    0.000 enum.py:633(value)
        1    0.000    0.000    0.000    0.000 contextlib.py:81(__init__)
        8    0.000    0.000    0.000    0.000 base.py:54(trainer)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
        1    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x7f0a4d51d440}
        3    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 progress.py:49(reset)
        1    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
       16    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._set_grad_enabled}
        2    0.000    0.000    0.000    0.000 {built-in method torch.is_grad_enabled}
        1    0.000    0.000    0.000    0.000 utils.py:51(void)
        1    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:2073(validate_loop)
        1    0.000    0.000    0.000    0.000 _jit_internal.py:958(is_scripting)



Profile stats for: on_validation_model_eval
         18240 function calls (16097 primitive calls) in 0.006 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.006    0.006 hooks.py:164(on_validation_model_eval)
        1    0.000    0.000    0.006    0.006 module.py:1842(eval)
   1072/1    0.001    0.000    0.006    0.006 module.py:1820(train)
     1072    0.002    0.000    0.003    0.000 module.py:1210(__setattr__)
     2143    0.001    0.000    0.002    0.000 module.py:1719(children)
4288/3216    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
     2143    0.001    0.000    0.001    0.000 module.py:1728(named_children)
     1072    0.001    0.000    0.001    0.000 parameter.py:9(__instancecheck__)
     3217    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
     1071    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
     1072    0.000    0.000    0.000    0.000 {function _ParameterMeta.__instancecheck__ at 0x7f0a4d51d440}
     1072    0.000    0.000    0.000    0.000 {method 'items' of 'collections.OrderedDict' objects}
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 trainer.py:1735(model)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 accelerator.py:159(model)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:162(model)
        2    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_start
         1014 function calls in 0.001 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.001    0.001 callback_hook.py:213(on_validation_start)
        1    0.000    0.000    0.001    0.001 tqdm_progress.py:247(on_validation_start)
        2    0.000    0.000    0.000    0.000 std.py:1339(refresh)
        2    0.000    0.000    0.000    0.000 std.py:1478(display)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:183(init_validation_tqdm)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:347(reset)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:35(__init__)
        1    0.000    0.000    0.000    0.000 std.py:1374(reset)
        1    0.000    0.000    0.000    0.000 asyncio.py:23(__init__)
        1    0.000    0.000    0.000    0.000 std.py:846(__init__)
        2    0.000    0.000    0.000    0.000 std.py:1164(__str__)
        2    0.000    0.000    0.000    0.000 std.py:355(format_meter)
        4    0.000    0.000    0.000    0.000 utils.py:333(disp_len)
        4    0.000    0.000    0.000    0.000 utils.py:329(_text_width)
        5    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
      336    0.000    0.000    0.000    0.000 utils.py:330(<genexpr>)
        2    0.000    0.000    0.000    0.000 std.py:348(print_status)
        3    0.000    0.000    0.000    0.000 utils.py:282(_screen_shape_linux)
        1    0.000    0.000    0.000    0.000 utils.py:341(disp_trim)
      332    0.000    0.000    0.000    0.000 {built-in method unicodedata.east_asian_width}
        1    0.000    0.000    0.000    0.000 std.py:560(__new__)
        4    0.000    0.000    0.000    0.000 std.py:1455(moveto)
       12    0.000    0.000    0.000    0.000 utils.py:143(inner)
        2    0.000    0.000    0.000    0.000 std.py:1460(format_dict)
        6    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        3    0.000    0.000    0.000    0.000 {built-in method fcntl.ioctl}
        8    0.000    0.000    0.000    0.000 {method 'format' of 'str' objects}
        1    0.000    0.000    0.000    0.000 base.py:102(total_val_batches)
        4    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        4    0.000    0.000    0.000    0.000 std.py:104(acquire)
        4    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 utils.py:162(__init__)
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        2    0.000    0.000    0.000    0.000 std.py:342(fp_write)
        2    0.000    0.000    0.000    0.000 std.py:288(format_interval)
        4    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        1    0.000    0.000    0.000    0.000 trainer.py:1842(enable_validation)
        4    0.000    0.000    0.000    0.000 std.py:108(release)
        4    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        9    0.000    0.000    0.000    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
       18    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
       15    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        2    0.000    0.000    0.000    0.000 utils.py:222(_is_ascii)
       20    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 std.py:329(status_printer)
        2    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        1    0.000    0.000    0.000    0.000 trainer.py:2016(sanity_checking)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:81(add)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 utils.py:215(_supports_unicode)
        1    0.000    0.000    0.000    0.000 std.py:188(__format__)
        8    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        4    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:337(convert_inf)
        1    0.000    0.000    0.000    0.000 model_helpers.py:22(is_overridden)
        4    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:129(is_enabled)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:133(is_disabled)
        4    0.000    0.000    0.000    0.000 utils.py:88(__getattr__)
        1    0.000    0.000    0.000    0.000 utils.py:105(__init__)
        2    0.000    0.000    0.000    0.000 utils.py:136(disable_on_exception)
        4    0.000    0.000    0.000    0.000 utils.py:171(__eq__)
        1    0.000    0.000    0.000    0.000 std.py:155(__init__)
        2    0.000    0.000    0.000    0.000 {built-in method utcfromtimestamp}
        4    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        4    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        5    0.000    0.000    0.000    0.000 {built-in method builtins.divmod}
       21    0.000    0.000    0.000    0.000 {built-in method builtins.ord}
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        4    0.000    0.000    0.000    0.000 base.py:57(trainer)
        1    0.000    0.000    0.000    0.000 base.py:167(on_validation_start)
        1    0.000    0.000    0.000    0.000 std.py:1161(__del__)
        3    0.000    0.000    0.000    0.000 utils.py:101(wrapper_setattr)
        1    0.000    0.000    0.000    0.000 utils.py:201(_is_utf)
        2    0.000    0.000    0.000    0.000 std.py:233(__call__)
        1    0.000    0.000    0.000    0.000 std.py:657(get_lock)
        1    0.000    0.000    0.000    0.000 _monitor.py:94(report)
        6    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:2035(current_epoch)
        4    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        4    0.000    0.000    0.000    0.000 types.py:164(__get__)
        4    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        3    0.000    0.000    0.000    0.000 {built-in method time.time}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 {method 'update' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 fit_loop.py:55(current_epoch)
        1    0.000    0.000    0.000    0.000 base.py:69(val_batch_idx)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:125(process_position)
        1    0.000    0.000    0.000    0.000 std.py:1171(__hash__)
        1    0.000    0.000    0.000    0.000 std.py:1279(close)
        1    0.000    0.000    0.000    0.000 utils.py:57(__init__)
        1    0.000    0.000    0.000    0.000 utils.py:61(__format__)
        1    0.000    0.000    0.000    0.000 utils.py:231(_screen_shape_wrapper)
        4    0.000    0.000    0.000    0.000 utils.py:319(_term_move_up)
        1    0.000    0.000    0.000    0.000 std.py:169(colour)
        6    0.000    0.000    0.000    0.000 std.py:228(__init__)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:335(on_validation_start)
        2    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 trainer.py:2059(fit_loop)
        1    0.000    0.000    0.000    0.000 threading.py:507(is_set)
        4    0.000    0.000    0.000    0.000 enum.py:633(value)
        1    0.000    0.000    0.000    0.000 {built-in method math.isinf}
        2    0.000    0.000    0.000    0.000 {built-in method _weakref.proxy}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.len}
        1    0.000    0.000    0.000    0.000 {method 'encode' of 'str' objects}
        4    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        1    0.000    0.000    0.000    0.000 {built-in method __new__ of type object at 0x557142a379a0}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:121(refresh_rate)
        2    0.000    0.000    0.000    0.000 base.py:246(on_validation_start)
        1    0.000    0.000    0.000    0.000 std.py:165(colour)
        1    0.000    0.000    0.000    0.000 hooks.py:46(on_validation_start)
        4    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 {built-in method math.isnan}



Profile stats for: on_epoch_start
         45 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:125(on_epoch_start)
        3    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        3    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 base.py:160(on_epoch_start)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        4    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 hooks.py:184(on_epoch_start)



Profile stats for: on_validation_epoch_start
         45 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:95(on_validation_epoch_start)
        3    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        3    0.000    0.000    0.000    0.000 base.py:136(on_validation_epoch_start)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        4    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 hooks.py:202(on_validation_epoch_start)



Profile stats for: get_validate_batch
         79821 function calls (72219 primitive calls) in 5.856 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
11403/7602    0.007    0.000    5.844    0.001 contextlib.py:107(__enter__)
11403/7602    0.003    0.000    5.840    0.001 {built-in method builtins.next}
     3801    0.003    0.000    5.837    0.002 fetching.py:287(apply_profiler)
     3801    0.001    0.000    5.826    0.002 base.py:68(profile)
     3801    0.003    0.000    5.825    0.002 advanced.py:61(start)
     3801    5.823    0.002    5.823    0.002 {method 'enable' of '_lsprof.Profiler' objects}
    11403    0.005    0.000    0.016    0.000 contextlib.py:237(helper)
    11403    0.010    0.000    0.011    0.000 contextlib.py:81(__init__)
    11403    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
     3801    0.001    0.000    0.001    0.000 fetching.py:238(fetching_context)
     3801    0.000    0.000    0.000    0.000 fetching.py:243(on_fetch_start)



Profile stats for: fetch_next_validate_batch
         4731159 function calls (4715961 primitive calls) in 5.793 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
18997/7601    0.010    0.000    5.790    0.001 {built-in method builtins.next}
     3801    0.022    0.000    5.774    0.002 dataloader.py:647(__next__)
     3801    0.018    0.000    5.639    0.001 dataloader.py:1300(_next_data)
     3800    0.006    0.000    5.483    0.001 dataloader.py:1267(_get_data)
     3800    0.009    0.000    5.477    0.001 dataloader.py:1121(_try_get_data)
     3800    0.026    0.000    5.469    0.001 queues.py:91(get)
     3800    0.147    0.000    5.214    0.001 {built-in method _pickle.loads}
    19000    0.077    0.000    4.661    0.000 reductions.py:296(rebuild_storage_fd)
    19000    0.042    0.000    4.231    0.000 resource_sharer.py:55(detach)
    19000    0.082    0.000    3.516    0.000 resource_sharer.py:82(get_connection)
    19000    0.046    0.000    3.054    0.000 connection.py:483(Client)
    19000    0.087    0.000    1.765    0.000 connection.py:737(answer_challenge)
    60800    0.072    0.000    1.603    0.000 connection.py:208(recv_bytes)
    60800    0.080    0.000    1.506    0.000 connection.py:406(_recv_bytes)
   121600    0.132    0.000    1.391    0.000 connection.py:374(_recv)
   121600    1.227    0.000    1.227    0.000 {built-in method posix.read}
    19000    0.065    0.000    0.857    0.000 connection.py:722(deliver_challenge)
    19000    0.046    0.000    0.582    0.000 reduction.py:182(recv_handle)
    19000    0.073    0.000    0.437    0.000 reduction.py:149(recvfds)
    38000    0.022    0.000    0.406    0.000 hmac.py:142(new)
    38000    0.159    0.000    0.384    0.000 hmac.py:33(__init__)
    57000    0.102    0.000    0.370    0.000 connection.py:181(send_bytes)
    19000    0.074    0.000    0.353    0.000 connection.py:613(SocketClient)
    19000    0.346    0.000    0.346    0.000 {method 'recvmsg' of '_socket.socket' objects}
    19000    0.030    0.000    0.323    0.000 connection.py:202(send)
    76000    0.076    0.000    0.319    0.000 connection.py:390(_send_bytes)
    19000    0.036    0.000    0.315    0.000 reductions.py:90(rebuild_tensor)
    19000    0.040    0.000    0.279    0.000 _utils.py:131(_rebuild_tensor)
    76000    0.044    0.000    0.221    0.000 connection.py:365(_send)
    19000    0.036    0.000    0.214    0.000 reduction.py:48(dumps)
     3802    0.024    0.000    0.193    0.000 connection.py:907(wait)
    76000    0.171    0.000    0.171    0.000 {built-in method posix.write}
    19000    0.170    0.000    0.170    0.000 {built-in method torch.tensor}
     3800    0.010    0.000    0.168    0.000 connection.py:253(poll)
     3800    0.006    0.000    0.155    0.000 connection.py:413(_poll)
    19000    0.062    0.000    0.146    0.000 reduction.py:38(__init__)
    76000    0.034    0.000    0.125    0.000 hmac.py:61(<lambda>)
    19000    0.121    0.000    0.121    0.000 {method 'connect' of '_socket.socket' objects}
    38000    0.108    0.000    0.108    0.000 socket.py:139(__init__)
     3802    0.013    0.000    0.104    0.000 selectors.py:402(select)
    19000    0.100    0.000    0.100    0.000 {built-in method _new_shared_fd_cpu}
    38000    0.019    0.000    0.097    0.000 hmac.py:126(digest)
     3800    0.005    0.000    0.093    0.000 dataloader.py:1369(_process_data)
    76000    0.028    0.000    0.091    0.000 hashlib.py:139(__hash_new)
    19000    0.034    0.000    0.091    0.000 reductions.py:328(rebuild_typed_storage)
    19000    0.008    0.000    0.088    0.000 connection.py:262(__exit__)
     3800    0.015    0.000    0.087    0.000 dataloader.py:1349(_try_put_index)
     3802    0.085    0.000    0.085    0.000 {method 'poll' of 'select.poll' objects}
    19002    0.014    0.000    0.081    0.000 connection.py:173(close)
    19000    0.078    0.000    0.078    0.000 {method 'update' of 'dict' objects}
    38000    0.022    0.000    0.078    0.000 reductions.py:281(fd_id)
    19000    0.024    0.000    0.070    0.000 reductions.py:289(storage_from_cache)
    19000    0.035    0.000    0.067    0.000 reductions.py:61(__setitem__)
    38002    0.067    0.000    0.067    0.000 {built-in method posix.close}
    19002    0.007    0.000    0.066    0.000 connection.py:360(_close)
    19000    0.064    0.000    0.064    0.000 {method 'set_' of 'torch._C._TensorBase' objects}
    38000    0.027    0.000    0.064    0.000 hmac.py:117(_current)
    76000    0.063    0.000    0.063    0.000 {built-in method _hashlib.new}
     3798    0.019    0.000    0.058    0.000 queues.py:80(put)
    38000    0.056    0.000    0.056    0.000 {built-in method posix.fstat}
     7602    0.005    0.000    0.055    0.000 _ops.py:138(__call__)
    19000    0.016    0.000    0.051    0.000 socket.py:457(fromfd)
   509205    0.049    0.000    0.049    0.000 {built-in method builtins.len}
     3801    0.011    0.000    0.048    0.000 profiler.py:445(__enter__)
        1    0.000    0.000    0.044    0.044 dataloader.py:1402(_shutdown_workers)
        2    0.000    0.000    0.044    0.022 process.py:133(join)
        2    0.000    0.000    0.044    0.022 popen_fork.py:41(wait)
    19000    0.041    0.000    0.041    0.000 {built-in method posix.urandom}
    38000    0.014    0.000    0.041    0.000 socket.py:158(__exit__)
     3801    0.007    0.000    0.039    0.000 profiler.py:436(__init__)
     3802    0.008    0.000    0.038    0.000 selectors.py:351(register)
    38000    0.026    0.000    0.035    0.000 connection.py:95(address_type)
   152000    0.035    0.000    0.035    0.000 {method 'update' of '_hashlib.HASH' objects}
     3801    0.034    0.000    0.034    0.000 {built-in method torch._ops.profiler._record_function_enter}
    76000    0.034    0.000    0.034    0.000 {method 'digest' of '_hashlib.HASH' objects}
    19000    0.023    0.000    0.034    0.000 reductions.py:57(get)
     3801    0.032    0.000    0.032    0.000 {built-in method torch.zeros}
    19000    0.024    0.000    0.031    0.000 storage.py:362(__init__)
    19000    0.013    0.000    0.030    0.000 reductions.py:37(__del__)
     3800    0.014    0.000    0.029    0.000 threading.py:335(notify)
   163400    0.028    0.000    0.028    0.000 connection.py:134(_check_closed)
    19000    0.010    0.000    0.027    0.000 socket.py:416(close)
    60800    0.027    0.000    0.027    0.000 {built-in method _struct.unpack}
    19000    0.022    0.000    0.027    0.000 reductions.py:28(__init__)
     3802    0.012    0.000    0.026    0.000 selectors.py:234(register)
     3801    0.008    0.000    0.026    0.000 profiler.py:449(__exit__)
    19000    0.021    0.000    0.026    0.000 storage.py:295(__new__)
    19000    0.025    0.000    0.025    0.000 {method 'dump' of '_pickle.Pickler' objects}
    57003    0.024    0.000    0.024    0.000 {built-in method builtins.hasattr}
    19002    0.008    0.000    0.023    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
   178602    0.023    0.000    0.023    0.000 {built-in method builtins.isinstance}
    76000    0.022    0.000    0.022    0.000 {method 'translate' of 'bytes' objects}
   121600    0.020    0.000    0.020    0.000 {method 'write' of '_io.BytesIO' objects}
    19000    0.012    0.000    0.018    0.000 <frozen importlib._bootstrap>:416(parent)
    38000    0.012    0.000    0.018    0.000 hmac.py:99(update)
    19000    0.015    0.000    0.018    0.000 socket.py:422(detach)
    19000    0.018    0.000    0.018    0.000 connection.py:117(__init__)
    19000    0.009    0.000    0.017    0.000 storage.py:636(_free_weak_ref)
    19000    0.008    0.000    0.017    0.000 socket.py:412(_real_close)
     3802    0.007    0.000    0.016    0.000 selectors.py:347(__init__)
    19000    0.016    0.000    0.016    0.000 {built-in method _socket.dup}
    76000    0.016    0.000    0.016    0.000 {built-in method _struct.pack}
     3801    0.016    0.000    0.016    0.000 {built-in method torch._ops.profiler._record_function_exit}
   121600    0.014    0.000    0.014    0.000 {method 'getvalue' of '_io.BytesIO' objects}
7602/3801    0.004    0.000    0.014    0.000 contextlib.py:116(__exit__)
     3800    0.003    0.000    0.013    0.000 dataloader.py:641(_next_index)
    38000    0.012    0.000    0.012    0.000 {method 'ljust' of 'bytes' objects}
    22800    0.008    0.000    0.012    0.000 connection.py:168(fileno)
    19000    0.012    0.000    0.012    0.000 {built-in method _new_with_weak_ptr}
    22801    0.012    0.000    0.012    0.000 {function SharedCache.get at 0x7f0a4cfc7320}
    38000    0.011    0.000    0.011    0.000 {method 'copy' of '_hashlib.HASH' objects}
     3802    0.002    0.000    0.011    0.000 selectors.py:215(_fileobj_lookup)
     3800    0.011    0.000    0.011    0.000 {method 'release' of '_thread.lock' objects}
     3801    0.001    0.000    0.010    0.000 fetching.py:287(apply_profiler)
    76000    0.010    0.000    0.010    0.000 connection.py:142(_check_writable)
    19000    0.010    0.000    0.010    0.000 {method 'setblocking' of '_socket.socket' objects}
     3802    0.006    0.000    0.009    0.000 selectors.py:21(_fileobj_to_fd)
    19000    0.009    0.000    0.009    0.000 {function socket.close at 0x7f0a4cfb6170}
    64600    0.009    0.000    0.009    0.000 connection.py:138(_check_readable)
    38000    0.009    0.000    0.009    0.000 {method 'startswith' of 'str' objects}
    19000    0.008    0.000    0.008    0.000 connection.py:83(_validate_family)
     3802    0.005    0.000    0.008    0.000 selectors.py:209(__init__)
     3797    0.008    0.000    0.008    0.000 sampler.py:234(__iter__)
    19000    0.008    0.000    0.008    0.000 {built-in method _free_weak_ref}
     3802    0.002    0.000    0.008    0.000 selectors.py:202(__exit__)
    19006    0.007    0.000    0.007    0.000 {built-in method posix.getpid}
     3801    0.002    0.000    0.007    0.000 base.py:68(profile)
    19000    0.007    0.000    0.007    0.000 {method 'copy' of 'dict' objects}
    22802    0.006    0.000    0.006    0.000 {built-in method __new__ of type object at 0x557142a379a0}
    19000    0.006    0.000    0.006    0.000 {method 'rpartition' of 'str' objects}
    19000    0.006    0.000    0.006    0.000 {built-in method _socket.CMSG_SPACE}
    19000    0.006    0.000    0.006    0.000 {method 'frombytes' of 'array.array' objects}
    19000    0.006    0.000    0.006    0.000 {method 'getbuffer' of '_io.BytesIO' objects}
    38000    0.005    0.000    0.005    0.000 storage.py:433(_untyped)
    19000    0.005    0.000    0.005    0.000 process.py:204(authkey)
     3802    0.004    0.000    0.005    0.000 selectors.py:268(close)
     7604    0.005    0.000    0.005    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
    19000    0.005    0.000    0.005    0.000 {method '_weak_ref' of 'torch._C.StorageBase' objects}
     3800    0.004    0.000    0.005    0.000 threading.py:240(__enter__)
     3801    0.003    0.000    0.005    0.000 advanced.py:66(stop)
    38000    0.004    0.000    0.004    0.000 socket.py:155(__enter__)
    19000    0.004    0.000    0.004    0.000 {built-in method builtins.getattr}
    38000    0.004    0.000    0.004    0.000 {built-in method builtins.callable}
    19000    0.004    0.000    0.004    0.000 connection.py:130(__del__)
     3802    0.002    0.000    0.004    0.000 <string>:1(__new__)
     3802    0.004    0.000    0.004    0.000 {method 'register' of 'select.poll' objects}
    19000    0.003    0.000    0.003    0.000 process.py:36(current_process)
     3800    0.002    0.000    0.003    0.000 threading.py:255(_is_owned)
     3802    0.003    0.000    0.003    0.000 {built-in method math.ceil}
     3802    0.003    0.000    0.003    0.000 selectors.py:63(__init__)
     3800    0.002    0.000    0.003    0.000 threading.py:243(__exit__)
    19000    0.003    0.000    0.003    0.000 {function socket.detach at 0x7f0a4cfb6200}
    19000    0.003    0.000    0.003    0.000 connection.py:259(__enter__)
     3802    0.002    0.000    0.002    0.000 connection.py:923(<listcomp>)
    11402    0.002    0.000    0.002    0.000 {built-in method time.monotonic}
     3802    0.002    0.000    0.002    0.000 selectors.py:275(_key_from_fd)
     7603    0.002    0.000    0.002    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
     3800    0.001    0.000    0.001    0.000 {method 'acquire' of '_thread.lock' objects}
     3800    0.001    0.000    0.001    0.000 {method '__enter__' of '_thread.lock' objects}
     3802    0.001    0.000    0.001    0.000 {method 'clear' of 'dict' objects}
     3802    0.001    0.000    0.001    0.000 {built-in method select.poll}
     3802    0.001    0.000    0.001    0.000 selectors.py:199(__enter__)
     3800    0.001    0.000    0.001    0.000 {method 'remove' of 'collections.deque' objects}
     3800    0.001    0.000    0.001    0.000 {method 'append' of 'collections.deque' objects}
     3802    0.001    0.000    0.001    0.000 {method 'append' of 'list' objects}
     3800    0.001    0.000    0.001    0.000 {method '__exit__' of '_thread.lock' objects}
     3801    0.001    0.000    0.001    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 queues.py:131(close)
        4    0.000    0.000    0.000    0.000 popen_fork.py:25(poll)
        1    0.000    0.000    0.000    0.000 synchronize.py:334(set)
        2    0.000    0.000    0.000    0.000 dataloader.py:1376(_mark_worker_as_unavailable)
        2    0.000    0.000    0.000    0.000 util.py:205(__call__)
        2    0.000    0.000    0.000    0.000 {built-in method posix.waitpid}
        2    0.000    0.000    0.000    0.000 queues.py:197(_finalize_close)
        3    0.000    0.000    0.000    0.000 synchronize.py:229(__enter__)
        1    0.000    0.000    0.000    0.000 synchronize.py:296(notify_all)
        1    0.000    0.000    0.000    0.000 synchronize.py:270(notify)
        3    0.000    0.000    0.000    0.000 synchronize.py:94(__enter__)
        2    0.000    0.000    0.000    0.000 synchronize.py:327(is_set)
      2/1    0.000    0.000    0.000    0.000 {method 'throw' of 'generator' objects}
        3    0.000    0.000    0.000    0.000 synchronize.py:232(__exit__)
        2    0.000    0.000    0.000    0.000 queues.py:147(cancel_join_thread)
        2    0.000    0.000    0.000    0.000 process.py:144(is_alive)
        3    0.000    0.000    0.000    0.000 {method '__enter__' of '_multiprocessing.SemLock' objects}
        3    0.000    0.000    0.000    0.000 synchronize.py:97(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method torch._C._remove_worker_pids}
        2    0.000    0.000    0.000    0.000 {built-in method posix.WIFSIGNALED}
        4    0.000    0.000    0.000    0.000 {method 'discard' of 'set' objects}
        2    0.000    0.000    0.000    0.000 {method 'pop' of 'dict' objects}
        4    0.000    0.000    0.000    0.000 util.py:48(debug)
        4    0.000    0.000    0.000    0.000 process.py:90(_check_closed)
        3    0.000    0.000    0.000    0.000 {method '__exit__' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 {built-in method posix.WIFEXITED}
        2    0.000    0.000    0.000    0.000 {built-in method posix.WEXITSTATUS}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        2    0.000    0.000    0.000    0.000 util.py:44(sub_debug)
        1    0.000    0.000    0.000    0.000 {method '_is_mine' of '_multiprocessing.SemLock' objects}



Profile stats for: evaluation_batch_to_device
         573800 function calls (551000 primitive calls) in 0.952 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     3800    0.010    0.000    0.938    0.000 accelerator.py:192(batch_to_device)
     3800    0.012    0.000    0.898    0.000 lightning.py:284(_apply_batch_transfer_handler)
     3800    0.005    0.000    0.674    0.000 hooks.py:652(transfer_batch_to_device)
     3800    0.008    0.000    0.669    0.000 apply_func.py:244(move_data_to_device)
22800/3800    0.070    0.000    0.661    0.000 apply_func.py:69(apply_to_collection)
    19000    0.025    0.000    0.552    0.000 apply_func.py:261(batch_to)
    19000    0.526    0.000    0.526    0.000 {method 'to' of 'torch._C._TensorBase' objects}
     3800    0.012    0.000    0.212    0.000 signature_utils.py:18(is_param_in_hook_signature)
     3800    0.004    0.000    0.199    0.000 inspect.py:3081(signature)
     3800    0.005    0.000    0.195    0.000 inspect.py:2829(from_callable)
7600/3800    0.028    0.000    0.190    0.000 inspect.py:2198(_signature_from_callable)
     3800    0.040    0.000    0.105    0.000 inspect.py:2117(_signature_from_function)
    95000    0.023    0.000    0.054    0.000 {built-in method builtins.isinstance}
     7600    0.031    0.000    0.042    0.000 inspect.py:2750(__init__)
     3800    0.013    0.000    0.041    0.000 inspect.py:1799(_signature_bound_method)
    15200    0.021    0.000    0.036    0.000 inspect.py:2467(__init__)
    34200    0.007    0.000    0.031    0.000 abc.py:137(__instancecheck__)
    34200    0.024    0.000    0.024    0.000 {built-in method _abc._abc_instancecheck}
     3800    0.005    0.000    0.024    0.000 inspect.py:2843(replace)
     3800    0.003    0.000    0.020    0.000 accelerator.py:172(lightning_module)
     3800    0.002    0.000    0.017    0.000 training_type_plugin.py:171(lightning_module)
     3800    0.003    0.000    0.014    0.000 base.py:104(unwrap_lightning_module)
    15200    0.009    0.000    0.012    0.000 enum.py:289(__call__)
     3800    0.007    0.000    0.011    0.000 inspect.py:484(unwrap)
     3800    0.003    0.000    0.011    0.000 contextlib.py:116(__exit__)
    19000    0.006    0.000    0.008    0.000 inspect.py:2799(<genexpr>)
     3800    0.001    0.000    0.007    0.000 {built-in method builtins.next}
    34200    0.007    0.000    0.007    0.000 {method 'append' of 'list' objects}
     3800    0.002    0.000    0.006    0.000 base.py:68(profile)
     3800    0.003    0.000    0.004    0.000 accelerator.py:180(root_device)
     3800    0.003    0.000    0.004    0.000 advanced.py:66(stop)
    15200    0.004    0.000    0.004    0.000 enum.py:531(__new__)
    22800    0.003    0.000    0.003    0.000 {method 'get' of 'dict' objects}
     7600    0.003    0.000    0.003    0.000 inspect.py:158(isfunction)
    26600    0.003    0.000    0.003    0.000 inspect.py:2517(name)
     3800    0.002    0.000    0.003    0.000 inspect.py:504(_is_wrapper)
    19000    0.002    0.000    0.002    0.000 inspect.py:2529(kind)
     3800    0.002    0.000    0.002    0.000 {method 'values' of 'mappingproxy' objects}
    15200    0.002    0.000    0.002    0.000 {method 'isidentifier' of 'str' objects}
     3800    0.001    0.000    0.001    0.000 trainer.py:1611(accelerator)
    11400    0.001    0.000    0.001    0.000 inspect.py:2521(default)
     7600    0.001    0.000    0.001    0.000 inspect.py:2835(parameters)
     3800    0.001    0.000    0.001    0.000 base.py:54(trainer)
     3800    0.001    0.000    0.001    0.000 single_device.py:63(root_device)
     7600    0.001    0.000    0.001    0.000 {built-in method builtins.callable}
     3800    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
     3800    0.001    0.000    0.001    0.000 {built-in method sys.getrecursionlimit}
     3800    0.001    0.000    0.001    0.000 {method 'items' of 'dict' objects}
     3800    0.001    0.000    0.001    0.000 {built-in method builtins.id}
     3800    0.001    0.000    0.001    0.000 {method 'disable' of '_lsprof.Profiler' objects}
     3800    0.001    0.000    0.001    0.000 hooks.py:744(on_after_batch_transfer)
     3800    0.000    0.000    0.000    0.000 hooks.py:709(on_before_batch_transfer)



Profile stats for: on_validation_batch_start
         171000 function calls in 0.062 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     3800    0.012    0.000    0.048    0.000 callback_hook.py:183(on_validation_batch_start)
    11400    0.006    0.000    0.035    0.000 trainer.py:1686(lightning_module)
    11400    0.004    0.000    0.026    0.000 accelerator.py:172(lightning_module)
    11400    0.004    0.000    0.022    0.000 training_type_plugin.py:171(lightning_module)
    11400    0.006    0.000    0.018    0.000 base.py:104(unwrap_lightning_module)
    22800    0.007    0.000    0.012    0.000 {built-in method builtins.isinstance}
     3800    0.002    0.000    0.007    0.000 contextlib.py:116(__exit__)
     3800    0.001    0.000    0.005    0.000 {built-in method builtins.next}
    11400    0.002    0.000    0.005    0.000 abc.py:137(__instancecheck__)
     3800    0.001    0.000    0.005    0.000 base.py:68(profile)
    15200    0.004    0.000    0.004    0.000 trainer.py:1611(accelerator)
     3800    0.002    0.000    0.003    0.000 advanced.py:66(stop)
    11400    0.003    0.000    0.003    0.000 {built-in method _abc._abc_instancecheck}
     7600    0.002    0.000    0.002    0.000 {built-in method builtins.getattr}
     3800    0.001    0.000    0.002    0.000 trainer.py:1615(training_type_plugin)
     3800    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
    11400    0.001    0.000    0.001    0.000 base.py:172(on_validation_batch_start)
     7600    0.001    0.000    0.001    0.000 {built-in method builtins.callable}
     3800    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
     3800    0.000    0.000    0.000    0.000 hooks.py:103(on_validation_batch_start)
     3800    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: evaluation_step_and_end
         228000 function calls (224200 primitive calls) in 408.496 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     3800    0.013    0.000  408.496    0.107 evaluation_epoch_loop.py:196(_evaluation_step)
     3800    0.003    0.000  408.399    0.107 contextlib.py:107(__enter__)
     3800    0.001    0.000  408.396    0.107 {built-in method builtins.next}
     3800    0.001    0.000  408.395    0.107 base.py:68(profile)
     3800    0.002    0.000  408.394    0.107 advanced.py:61(start)
     3800  408.392    0.107  408.392    0.107 {method 'enable' of '_lsprof.Profiler' objects}
     3800    0.010    0.000    0.037    0.000 evaluation_epoch_loop.py:264(_build_kwargs)
    11400    0.008    0.000    0.035    0.000 trainer.py:1968(testing)
    11400    0.014    0.000    0.028    0.000 enums.py:30(__eq__)
     3800    0.006    0.000    0.014    0.000 module.py:1210(__setattr__)
30400/26600    0.007    0.000    0.013    0.000 {built-in method builtins.isinstance}
     3800    0.002    0.000    0.012    0.000 trainer.py:1686(lightning_module)
    22800    0.006    0.000    0.010    0.000 types.py:164(__get__)
     3800    0.001    0.000    0.010    0.000 accelerator.py:172(lightning_module)
     3800    0.001    0.000    0.008    0.000 training_type_plugin.py:171(lightning_module)
     3800    0.002    0.000    0.007    0.000 base.py:104(unwrap_lightning_module)
     3800    0.002    0.000    0.007    0.000 contextlib.py:237(helper)
    19000    0.005    0.000    0.005    0.000 base.py:54(trainer)
     3800    0.004    0.000    0.005    0.000 contextlib.py:81(__init__)
     3800    0.003    0.000    0.004    0.000 parameter.py:9(__instancecheck__)
    22800    0.004    0.000    0.004    0.000 enum.py:633(value)
    22800    0.002    0.000    0.002    0.000 {method 'lower' of 'str' objects}
     3800    0.001    0.000    0.002    0.000 abc.py:137(__instancecheck__)
    11400    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
     3800    0.001    0.000    0.001    0.000 {built-in method _abc._abc_instancecheck}
     3800    0.001    0.000    0.001    0.000 trainer.py:1611(accelerator)
     3800    0.001    0.000    0.001    0.000 {built-in method builtins.getattr}
     3800    0.001    0.000    0.001    0.000 {function _ParameterMeta.__instancecheck__ at 0x7f0a4d51d440}



Profile stats for: validation_step
         44399200 function calls (39337600 primitive calls) in 408.212 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     3800    0.019    0.000  408.221    0.107 accelerator.py:230(validation_step)
     3800    0.006    0.000  407.994    0.107 training_type_plugin.py:218(validation_step)
     3800    0.282    0.000  407.987    0.107 EncoderDecoder.py:226(validation_step)
     3800  106.269    0.028  407.705    0.107 EncoderDecoder.py:125(predict)
3883600/7600    7.987    0.000  299.887    0.039 module.py:1124(_call_impl)
     7600    1.085    0.000  299.256    0.039 modeling_t5.py:868(forward)
   182400    1.704    0.000  294.454    0.002 modeling_t5.py:612(forward)
     3800    0.055    0.000  200.493    0.053 modeling_t5.py:1513(forward)
   273600   10.314    0.000  146.761    0.001 modeling_t5.py:417(forward)
   182400    3.644    0.000  120.444    0.001 modeling_t5.py:540(forward)
   182400    3.337    0.000   96.563    0.001 modeling_t5.py:304(forward)
  1645400   88.991    0.000   88.991    0.000 {built-in method torch._C._nn.linear}
   182400    3.266    0.000   75.977    0.000 modeling_t5.py:280(forward)
    91200    1.862    0.000   71.620    0.001 modeling_t5.py:572(forward)
   729600   14.118    0.000   54.936    0.000 lora.py:35(forward)
   915800    1.412    0.000   53.187    0.000 linear.py:113(forward)
   463600   28.268    0.000   50.621    0.000 modeling_t5.py:244(forward)
   547200    0.729    0.000   45.220    0.000 modeling_t5.py:455(project)
   547200   35.123    0.000   35.123    0.000 {built-in method torch.matmul}
   182400   17.867    0.000   28.722    0.000 activations.py:37(gelu_new)
   186200    8.832    0.000    8.832    0.000 {built-in method torch.pow}
   463600    8.593    0.000    8.593    0.000 {method 'pow' of 'torch._C._TensorBase' objects}
   463600    7.682    0.000    7.682    0.000 {method 'mean' of 'torch._C._TensorBase' objects}
   273600    0.264    0.000    6.966    0.000 functional.py:1804(softmax)
   273600    0.576    0.000    6.675    0.000 modeling_t5.py:451(unshape)
   273600    6.650    0.000    6.650    0.000 {method 'softmax' of 'torch._C._TensorBase' objects}
   820800    1.004    0.000    5.647    0.000 modeling_t5.py:447(shape)
   463600    5.076    0.000    5.076    0.000 {built-in method torch.rsqrt}
  9450600    5.008    0.000    5.008    0.000 module.py:1194(__getattr__)
   273600    4.438    0.000    4.438    0.000 {method 'contiguous' of 'torch._C._TensorBase' objects}
   927200    2.107    0.000    4.179    0.000 functional.py:1235(dropout)
   288800    3.558    0.000    3.558    0.000 {method 'float' of 'torch._C._TensorBase' objects}
  1368000    3.443    0.000    3.443    0.000 {method 'transpose' of 'torch._C._TensorBase' objects}
  1105800    3.386    0.000    3.386    0.000 {method 'view' of 'torch._C._TensorBase' objects}
   653600    0.607    0.000    3.373    0.000 dropout.py:57(forward)
   273600    3.184    0.000    3.184    0.000 {method 'type_as' of 'torch._C._TensorBase' objects}
  3883600    2.751    0.000    2.751    0.000 {built-in method torch._C._get_tracing_state}
   456000    0.501    0.000    2.344    0.000 container.py:192(__getitem__)
     7600    0.277    0.000    2.207    0.000 modeling_t5.py:399(compute_bias)
   748600    2.119    0.000    2.119    0.000 {method 'flatten' of 'torch._C._TensorBase' objects}
   182400    2.024    0.000    2.024    0.000 {built-in method torch.tanh}
   456000    0.910    0.000    1.693    0.000 container.py:183(_get_abs_string_index)
     7600    0.792    0.000    1.479    0.000 modeling_t5.py:351(_relative_position_bucket)
   927200    1.219    0.000    1.219    0.000 {built-in method torch.dropout}
     7600    0.378    0.000    0.860    0.000 modeling_utils.py:244(get_extended_attention_mask)
   490200    0.762    0.000    0.762    0.000 {method 'to' of 'torch._C._TensorBase' objects}
2226800/1124800    0.416    0.000    0.718    0.000 {built-in method builtins.len}
   927200    0.445    0.000    0.690    0.000 _VF.py:25(__getattr__)
  1102000    0.302    0.000    0.396    0.000 container.py:213(__len__)
38000/30400    0.014    0.000    0.383    0.000 {built-in method builtins.next}
    15200    0.032    0.000    0.347    0.000 sparse.py:157(forward)
    19000    0.345    0.000    0.345    0.000 {method 'tolist' of 'torch._C._TensorBase' objects}
    15200    0.017    0.000    0.310    0.000 functional.py:2099(embedding)
    15200    0.289    0.000    0.289    0.000 {built-in method torch.embedding}
     3800    0.089    0.000    0.278    0.000 modeling_utils.py:212(invert_attention_mask)
  1079200    0.265    0.000    0.265    0.000 {built-in method builtins.getattr}
    19000    0.009    0.000    0.261    0.000 modeling_utils.py:205(dtype)
    15200    0.076    0.000    0.260    0.000 file_utils.py:2268(__post_init__)
    19000    0.026    0.000    0.252    0.000 modeling_utils.py:129(get_parameter_dtype)
    11400    0.241    0.000    0.241    0.000 {method 'repeat' of 'torch._C._TensorBase' objects}
    19000    0.233    0.000    0.233    0.000 {built-in method torch.arange}
  1238800    0.220    0.000    0.220    0.000 {built-in method torch._C._has_torch_function_unary}
    38000    0.037    0.000    0.219    0.000 module.py:1621(parameters)
    11400    0.009    0.000    0.212    0.000 _tensor.py:26(wrapped)
    11400    0.009    0.000    0.201    0.000 _tensor.py:637(__rsub__)
    11400    0.192    0.000    0.192    0.000 {built-in method torch.rsub}
     7600    0.007    0.000    0.189    0.000 precision_plugin.py:238(val_step_context)
     3800    0.010    0.000    0.170    0.000 functional.py:2924(cross_entropy)
    38000    0.015    0.000    0.166    0.000 module.py:1645(named_parameters)
     7600    0.008    0.000    0.165    0.000 native_amp.py:103(forward_context)
   528200    0.160    0.000    0.160    0.000 {built-in method builtins.isinstance}
     3800    0.158    0.000    0.158    0.000 {built-in method torch._C._nn.cross_entropy_loss}
7600/3800    0.005    0.000    0.156    0.000 contextlib.py:107(__enter__)
    38000    0.061    0.000    0.156    0.000 module.py:1608(_named_members)
     7600    0.145    0.000    0.145    0.000 {method 'sum' of 'torch._C._TensorBase' objects}
     7600    0.124    0.000    0.124    0.000 {method 'min' of 'torch._C._TensorBase' objects}
     3800    0.007    0.000    0.119    0.000 native_amp.py:96(autocast_context_manager)
    11400    0.115    0.000    0.115    0.000 {built-in method torch.min}
     3800    0.019    0.000    0.112    0.000 autocast_mode.py:176(__init__)
     3800    0.010    0.000    0.102    0.000 <string>:2(__init__)
     7600    0.099    0.000    0.099    0.000 {built-in method torch.zeros_like}
     7600    0.096    0.000    0.096    0.000 {built-in method torch.where}
     7600    0.086    0.000    0.086    0.000 {built-in method torch.full_like}
   456000    0.080    0.000    0.080    0.000 {built-in method _operator.index}
     3800    0.017    0.000    0.078    0.000 __init__.py:85(is_bf16_supported)
72200/57000    0.073    0.000    0.078    0.000 configuration_utils.py:242(__getattribute__)
    83600    0.069    0.000    0.077    0.000 file_utils.py:2331(__setattr__)
     7600    0.074    0.000    0.074    0.000 {built-in method torch.log}
    15200    0.046    0.000    0.072    0.000 dataclasses.py:1013(fields)
   182400    0.072    0.000    0.072    0.000 {built-in method math.sqrt}
26600/11400    0.029    0.000    0.070    0.000 file_utils.py:2324(__getitem__)
     3800    0.067    0.000    0.067    0.000 {method 'max' of 'torch._C._TensorBase' objects}
    11400    0.018    0.000    0.065    0.000 tokenization_utils_base.py:1112(pad_token_id)
     3800    0.062    0.000    0.062    0.000 {built-in method torch.cat}
95000/57000    0.054    0.000    0.061    0.000 module.py:1775(named_modules)
11400/7600    0.014    0.000    0.056    0.000 contextlib.py:116(__exit__)
     3800    0.056    0.000    0.056    0.000 {built-in method torch.zeros}
    11400    0.018    0.000    0.055    0.000 file_utils.py:2343(to_tuple)
     3800    0.052    0.000    0.052    0.000 {built-in method torch.abs}
    30400    0.020    0.000    0.047    0.000 {built-in method builtins.all}
    15200    0.046    0.000    0.046    0.000 {method 'unsqueeze' of 'torch._C._TensorBase' objects}
     3800    0.009    0.000    0.046    0.000 __init__.py:349(get_device_properties)
    11400    0.008    0.000    0.038    0.000 tokenization_utils_fast.py:232(convert_tokens_to_ids)
     3800    0.038    0.000    0.038    0.000 {method 'long' of 'torch._C._TensorBase' objects}
    26600    0.009    0.000    0.036    0.000 file_utils.py:2347(<genexpr>)
     7600    0.034    0.000    0.034    0.000 {method 'permute' of 'torch._C._TensorBase' objects}
    26600    0.028    0.000    0.028    0.000 file_utils.py:2337(__setitem__)
    11400    0.007    0.000    0.028    0.000 tokenization_utils_fast.py:254(_convert_token_to_id_with_added_voc)
    38000    0.017    0.000    0.025    0.000 _tensor.py:731(__hash__)
    11400    0.021    0.000    0.021    0.000 {method 'token_to_id' of 'tokenizers.Tokenizer' objects}
    57000    0.011    0.000    0.021    0.000 {method 'add' of 'set' objects}
    98800    0.020    0.000    0.020    0.000 dataclasses.py:1028(<genexpr>)
     3800    0.013    0.000    0.020    0.000 autocast_mode.py:250(__exit__)
     7600    0.013    0.000    0.020    0.000 file_utils.py:2161(is_tensor)
     3800    0.012    0.000    0.018    0.000 autocast_mode.py:224(__enter__)
    45600    0.012    0.000    0.016    0.000 file_utils.py:2278(<genexpr>)
    38000    0.012    0.000    0.016    0.000 module.py:1666(<lambda>)
     3800    0.009    0.000    0.015    0.000 _utils.py:7(_get_device_index)
     7600    0.005    0.000    0.015    0.000 configuration_utils.py:370(use_return_dict)
     3800    0.014    0.000    0.014    0.000 {built-in method torch.cuda._get_device_properties}
    83600    0.014    0.000    0.014    0.000 file_utils.py:2274(<genexpr>)
     3800    0.004    0.000    0.013    0.000 __init__.py:480(current_device)
    15200    0.012    0.000    0.012    0.000 {method 'size' of 'torch._C._TensorBase' objects}
     7600    0.003    0.000    0.012    0.000 contextlib.py:237(helper)
     7600    0.006    0.000    0.011    0.000 __init__.py:77(is_available)
     3800    0.003    0.000    0.011    0.000 common.py:5(amp_definitely_not_available)
     7600    0.006    0.000    0.010    0.000 container.py:217(__iter__)
    11400    0.009    0.000    0.009    0.000 tokenization_utils_base.py:997(pad_token)
    95000    0.009    0.000    0.009    0.000 {method 'keys' of 'collections.OrderedDict' objects}
     3800    0.003    0.000    0.009    0.000 base.py:68(profile)
     7600    0.008    0.000    0.009    0.000 contextlib.py:81(__init__)
     7600    0.003    0.000    0.008    0.000 __init__.py:191(_lazy_init)
    72200    0.007    0.000    0.007    0.000 {method 'items' of 'collections.OrderedDict' objects}
    15200    0.007    0.000    0.007    0.000 file_utils.py:2326(<dictcomp>)
    15200    0.007    0.000    0.007    0.000 modeling_utils.py:304(get_head_mask)
     7600    0.007    0.000    0.007    0.000 {built-in method math.log}
     3800    0.004    0.000    0.006    0.000 advanced.py:66(stop)
     3800    0.002    0.000    0.006    0.000 __init__.py:454(device_count)
    19000    0.005    0.000    0.005    0.000 {built-in method torch._C._has_torch_function_variadic}
     7600    0.003    0.000    0.005    0.000 __init__.py:149(is_initialized)
     7600    0.004    0.000    0.005    0.000 file_utils.py:2153(is_torch_fx_proxy)
    22800    0.004    0.000    0.004    0.000 {method 'dim' of 'torch._C._TensorBase' objects}
     3800    0.003    0.000    0.004    0.000 _utils.py:503(_get_device_index)
    38000    0.004    0.000    0.004    0.000 {built-in method builtins.id}
    11400    0.004    0.000    0.004    0.000 {built-in method torch._C._cuda_getDeviceCount}
     7600    0.003    0.000    0.003    0.000 {built-in method builtins.iter}
     3800    0.003    0.000    0.003    0.000 {built-in method torch._C._cuda_getDevice}
     3800    0.003    0.000    0.003    0.000 {method 'split' of 'str' objects}
    11400    0.002    0.000    0.002    0.000 {built-in method torch._C._has_torch_function}
     7600    0.002    0.000    0.002    0.000 {built-in method torch.get_autocast_gpu_dtype}
     3800    0.002    0.000    0.002    0.000 {built-in method torch.clear_autocast_cache}
    15200    0.002    0.000    0.002    0.000 {method 'values' of 'dict' objects}
    15200    0.002    0.000    0.002    0.000 _jit_internal.py:958(is_scripting)
    11400    0.002    0.000    0.002    0.000 {method 'values' of 'collections.OrderedDict' objects}
     3800    0.002    0.000    0.002    0.000 {built-in method torch.autocast_decrement_nesting}
     7600    0.002    0.000    0.002    0.000 {built-in method torch.set_autocast_enabled}
     7600    0.002    0.000    0.002    0.000 {built-in method torch._C._cuda_isInBadFork}
     7600    0.002    0.000    0.002    0.000 {built-in method torch.set_autocast_gpu_dtype}
     7600    0.002    0.000    0.002    0.000 {built-in method torch.set_autocast_cache_enabled}
     7600    0.001    0.000    0.001    0.000 {built-in method torch.is_autocast_cache_enabled}
     7600    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
     3800    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
     3800    0.001    0.000    0.001    0.000 {built-in method torch.is_autocast_enabled}
     3800    0.001    0.000    0.001    0.000 training_type_plugin.py:162(model)
     3800    0.001    0.000    0.001    0.000 _reduction.py:7(get_enum)
     7600    0.001    0.000    0.001    0.000 file_utils.py:334(is_torch_available)
     3800    0.001    0.000    0.001    0.000 base.py:54(trainer)
     7600    0.001    0.000    0.001    0.000 file_utils.py:415(is_torch_fx_available)
     3800    0.001    0.000    0.001    0.000 trainer.py:1611(accelerator)
     3800    0.001    0.000    0.001    0.000 {built-in method torch.autocast_increment_nesting}
     3800    0.001    0.000    0.001    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: validation_step_end
         68400 function calls in 0.019 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     3800    0.002    0.000    0.007    0.000 contextlib.py:116(__exit__)
     3800    0.001    0.000    0.006    0.000 {built-in method builtins.next}
     7600    0.003    0.000    0.005    0.000 trainer.py:1615(training_type_plugin)
     3800    0.002    0.000    0.005    0.000 base.py:68(profile)
    11400    0.004    0.000    0.004    0.000 {built-in method builtins.getattr}
     3800    0.002    0.000    0.003    0.000 advanced.py:66(stop)
     7600    0.002    0.000    0.002    0.000 trainer.py:1611(accelerator)
     3800    0.001    0.000    0.001    0.000 {built-in method builtins.hasattr}
     7600    0.001    0.000    0.001    0.000 {built-in method builtins.callable}
     3800    0.001    0.000    0.001    0.000 lightning.py:879(validation_step_end)
     3800    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
     3800    0.000    0.000    0.000    0.000 training_type_plugin.py:230(validation_step_end)
     3800    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_batch_end
         3064606 function calls in 1.200 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     3800    0.016    0.000    1.184    0.000 callback_hook.py:188(on_validation_batch_end)
     3800    0.022    0.000    1.123    0.000 tqdm_progress.py:257(on_validation_batch_end)
     3800    0.010    0.000    1.075    0.000 tqdm_progress.py:324(_update_bar)
     3800    0.024    0.000    1.062    0.000 std.py:1212(update)
     3785    0.010    0.000    1.018    0.000 std.py:1339(refresh)
     3785    0.015    0.000    0.989    0.000 std.py:1478(display)
     3785    0.014    0.000    0.688    0.000 std.py:1164(__str__)
     3785    0.191    0.000    0.581    0.000 std.py:355(format_meter)
    11355    0.008    0.000    0.443    0.000 utils.py:333(disp_len)
    11355    0.008    0.000    0.424    0.000 utils.py:329(_text_width)
    11355    0.088    0.000    0.416    0.000 {built-in method builtins.sum}
  1194958    0.209    0.000    0.328    0.000 utils.py:330(<genexpr>)
     3785    0.007    0.000    0.210    0.000 std.py:348(print_status)
     3785    0.003    0.000    0.179    0.000 utils.py:341(disp_trim)
  1183603    0.118    0.000    0.118    0.000 {built-in method unicodedata.east_asian_width}
     3785    0.019    0.000    0.093    0.000 std.py:1460(format_dict)
     7570    0.022    0.000    0.075    0.000 std.py:1455(moveto)
    22710    0.006    0.000    0.075    0.000 utils.py:143(inner)
     3785    0.024    0.000    0.068    0.000 utils.py:282(_screen_shape_linux)
    11355    0.061    0.000    0.061    0.000 {method 'write' of '_io.TextIOWrapper' objects}
    30280    0.041    0.000    0.057    0.000 {method 'format' of 'str' objects}
    11400    0.007    0.000    0.044    0.000 trainer.py:1686(lightning_module)
    11400    0.005    0.000    0.033    0.000 accelerator.py:172(lightning_module)
     3785    0.005    0.000    0.031    0.000 std.py:342(fp_write)
     3785    0.026    0.000    0.030    0.000 {built-in method fcntl.ioctl}
    11400    0.005    0.000    0.028    0.000 training_type_plugin.py:171(lightning_module)
    22710    0.024    0.000    0.024    0.000 std.py:233(__call__)
    11400    0.007    0.000    0.023    0.000 base.py:104(unwrap_lightning_module)
     7570    0.016    0.000    0.023    0.000 utils.py:222(_is_ascii)
     7570    0.009    0.000    0.021    0.000 std.py:288(format_interval)
    34170    0.010    0.000    0.018    0.000 {built-in method builtins.isinstance}
     3785    0.013    0.000    0.015    0.000 std.py:188(__format__)
    11355    0.003    0.000    0.014    0.000 <frozen importlib._bootstrap>:1009(_handle_fromlist)
     3800    0.007    0.000    0.014    0.000 enums.py:30(__eq__)
    22725    0.014    0.000    0.014    0.000 {built-in method builtins.hasattr}
     3785    0.007    0.000    0.011    0.000 std.py:104(acquire)
    11355    0.011    0.000    0.011    0.000 {method 'sub' of 're.Pattern' objects}
     3785    0.010    0.000    0.010    0.000 {built-in method now}
     3800    0.002    0.000    0.009    0.000 contextlib.py:116(__exit__)
     3800    0.004    0.000    0.009    0.000 tqdm_progress.py:321(_should_update)
    11400    0.003    0.000    0.008    0.000 abc.py:137(__instancecheck__)
    11355    0.008    0.000    0.008    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
     3785    0.006    0.000    0.007    0.000 std.py:108(release)
     3785    0.005    0.000    0.007    0.000 std.py:155(__init__)
     3800    0.001    0.000    0.007    0.000 {built-in method builtins.next}
     3800    0.002    0.000    0.006    0.000 base.py:68(profile)
    79485    0.006    0.000    0.006    0.000 {built-in method builtins.ord}
    18955    0.006    0.000    0.006    0.000 {built-in method builtins.getattr}
    11400    0.005    0.000    0.005    0.000 {built-in method _abc._abc_instancecheck}
     7600    0.003    0.000    0.005    0.000 types.py:164(__get__)
     3800    0.003    0.000    0.004    0.000 tqdm_progress.py:129(is_enabled)
    15200    0.004    0.000    0.004    0.000 trainer.py:1611(accelerator)
     3785    0.002    0.000    0.004    0.000 utils.py:88(__getattr__)
     3800    0.003    0.000    0.004    0.000 advanced.py:66(stop)
     7570    0.003    0.000    0.003    0.000 utils.py:319(_term_move_up)
    18925    0.003    0.000    0.003    0.000 {built-in method builtins.divmod}
     7570    0.003    0.000    0.003    0.000 {built-in method builtins.max}
     3785    0.003    0.000    0.003    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
     3800    0.003    0.000    0.003    0.000 base.py:170(on_validation_batch_end)
     3785    0.003    0.000    0.003    0.000 utils.py:57(__init__)
     3800    0.001    0.000    0.002    0.000 trainer.py:1615(training_type_plugin)
     3800    0.002    0.000    0.002    0.000 {built-in method builtins.min}
    11400    0.002    0.000    0.002    0.000 tqdm_progress.py:121(refresh_rate)
    11370    0.002    0.000    0.002    0.000 {built-in method time.time}
     3785    0.002    0.000    0.002    0.000 utils.py:61(__format__)
     7600    0.002    0.000    0.002    0.000 enum.py:633(value)
     3785    0.002    0.000    0.002    0.000 std.py:169(colour)
     3785    0.001    0.000    0.001    0.000 {method 'update' of 'dict' objects}
     3785    0.001    0.000    0.001    0.000 {method 'acquire' of '_thread.RLock' objects}
     7600    0.001    0.000    0.001    0.000 {method 'lower' of 'str' objects}
     3800    0.001    0.000    0.001    0.000 base.py:69(val_batch_idx)
     7600    0.001    0.000    0.001    0.000 base.py:178(on_validation_batch_end)
     3785    0.001    0.000    0.001    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
     7600    0.001    0.000    0.001    0.000 {built-in method builtins.callable}
     7570    0.001    0.000    0.001    0.000 {built-in method builtins.len}
     3800    0.001    0.000    0.001    0.000 {method 'get' of 'dict' objects}
     3785    0.001    0.000    0.001    0.000 {built-in method builtins.abs}
     3785    0.001    0.000    0.001    0.000 {method 'release' of '_thread.RLock' objects}
     3785    0.001    0.000    0.001    0.000 std.py:165(colour)
     3800    0.000    0.000    0.000    0.000 hooks.py:112(on_validation_batch_end)
     3800    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_epoch_end
         50 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:100(on_validation_epoch_end)
        3    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:264(on_validation_epoch_end)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:324(_update_bar)
        4    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        3    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:129(is_enabled)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.min}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        2    0.000    0.000    0.000    0.000 tqdm_progress.py:121(refresh_rate)
        2    0.000    0.000    0.000    0.000 base.py:140(on_validation_epoch_end)
        1    0.000    0.000    0.000    0.000 hooks.py:205(on_validation_epoch_end)



Profile stats for: on_epoch_end
         45 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:130(on_epoch_end)
        3    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        4    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        3    0.000    0.000    0.000    0.000 base.py:164(on_epoch_end)
        1    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 hooks.py:187(on_epoch_end)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}



Profile stats for: on_validation_end
         126 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:218(on_validation_end)
        1    0.000    0.000    0.000    0.000 tqdm_progress.py:268(on_validation_end)
        1    0.000    0.000    0.000    0.000 std.py:1279(close)
        1    0.000    0.000    0.000    0.000 std.py:583(_decr_instances)
        1    0.000    0.000    0.000    0.000 std.py:1478(display)
        2    0.000    0.000    0.000    0.000 std.py:1455(moveto)
        7    0.000    0.000    0.000    0.000 utils.py:143(inner)
        1    0.000    0.000    0.000    0.000 std.py:348(print_status)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:106(remove)
        3    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        2    0.000    0.000    0.000    0.000 {method 'remove' of 'set' objects}
        1    0.000    0.000    0.000    0.000 _weakrefset.py:58(__iter__)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        4    0.000    0.000    0.000    0.000 {method 'write' of '_io.TextIOWrapper' objects}
        1    0.000    0.000    0.000    0.000 enums.py:30(__eq__)
        2    0.000    0.000    0.000    0.000 std.py:112(__enter__)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        7    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 utils.py:333(disp_len)
        2    0.000    0.000    0.000    0.000 std.py:104(acquire)
        2    0.000    0.000    0.000    0.000 std.py:115(__exit__)
        2    0.000    0.000    0.000    0.000 std.py:108(release)
        1    0.000    0.000    0.000    0.000 std.py:342(fp_write)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        1    0.000    0.000    0.000    0.000 std.py:1300(fp_write)
        1    0.000    0.000    0.000    0.000 utils.py:74(__eq__)
        3    0.000    0.000    0.000    0.000 {method 'flush' of '_io.TextIOWrapper' objects}
        8    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 utils.py:329(_text_width)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:20(__enter__)
        3    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        2    0.000    0.000    0.000    0.000 base.py:250(on_validation_end)
        2    0.000    0.000    0.000    0.000 std.py:1167(_comparable)
        1    0.000    0.000    0.000    0.000 std.py:1171(__hash__)
        5    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        2    0.000    0.000    0.000    0.000 trainer.py:1615(training_type_plugin)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:26(__exit__)
        2    0.000    0.000    0.000    0.000 types.py:164(__get__)
        2    0.000    0.000    0.000    0.000 {method 'release' of '_thread.RLock' objects}
        1    0.000    0.000    0.000    0.000 {method 'sub' of 're.Pattern' objects}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.hasattr}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.max}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.sum}
        2    0.000    0.000    0.000    0.000 {method 'lower' of 'str' objects}
        2    0.000    0.000    0.000    0.000 utils.py:319(_term_move_up)
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_multiprocessing.SemLock' objects}
        1    0.000    0.000    0.000    0.000 _weakrefset.py:16(__init__)
        1    0.000    0.000    0.000    0.000 _weakrefset.py:52(_commit_removals)
        2    0.000    0.000    0.000    0.000 {method 'acquire' of '_thread.RLock' objects}
        3    0.000    0.000    0.000    0.000 {built-in method builtins.abs}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.id}
        1    0.000    0.000    0.000    0.000 {method 'add' of 'set' objects}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 utils.py:330(<genexpr>)
        1    0.000    0.000    0.000    0.000 training_type_plugin.py:351(on_validation_end)
        1    0.000    0.000    0.000    0.000 hooks.py:49(on_validation_end)
        2    0.000    0.000    0.000    0.000 {method 'release' of '_multiprocessing.SemLock' objects}
        2    0.000    0.000    0.000    0.000 enum.py:633(value)



Profile stats for: teardown
         42 function calls in 0.000 seconds

   Ordered by: cumulative time

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000    0.000    0.000 callback_hook.py:50(teardown)
        3    0.000    0.000    0.000    0.000 trainer.py:1686(lightning_module)
        3    0.000    0.000    0.000    0.000 accelerator.py:172(lightning_module)
        3    0.000    0.000    0.000    0.000 training_type_plugin.py:171(lightning_module)
        3    0.000    0.000    0.000    0.000 base.py:104(unwrap_lightning_module)
        1    0.000    0.000    0.000    0.000 contextlib.py:116(__exit__)
        6    0.000    0.000    0.000    0.000 {built-in method builtins.isinstance}
        1    0.000    0.000    0.000    0.000 {built-in method builtins.next}
        1    0.000    0.000    0.000    0.000 base.py:68(profile)
        1    0.000    0.000    0.000    0.000 advanced.py:66(stop)
        3    0.000    0.000    0.000    0.000 abc.py:137(__instancecheck__)
        2    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}
        3    0.000    0.000    0.000    0.000 trainer.py:1611(accelerator)
        3    0.000    0.000    0.000    0.000 {built-in method _abc._abc_instancecheck}
        2    0.000    0.000    0.000    0.000 {built-in method builtins.callable}
        1    0.000    0.000    0.000    0.000 {method 'get' of 'dict' objects}
        1    0.000    0.000    0.000    0.000 {method 'disable' of '_lsprof.Profiler' objects}
        1    0.000    0.000    0.000    0.000 hooks.py:399(teardown)
        3    0.000    0.000    0.000    0.000 base.py:71(teardown)


